{
	"name": "type2SCD_Orders",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Ods_Sales_Orders",
						"type": "DatasetReference"
					},
					"name": "odsDB"
				},
				{
					"dataset": {
						"referenceName": "Int_Orders",
						"type": "DatasetReference"
					},
					"name": "intergrationDB"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Surr_Orders",
						"type": "DatasetReference"
					},
					"name": "intergrationPlusAct"
				},
				{
					"dataset": {
						"referenceName": "Int_Orders",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "addingisactive"
				},
				{
					"name": "Lookup1"
				},
				{
					"name": "existingRow"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "AlterRow1"
				},
				{
					"name": "Select3"
				},
				{
					"name": "Select4"
				}
			],
			"script": "source(output(\n\t\tOrderID as integer,\n\t\tCustomerID as integer,\n\t\tSalespersonPersonID as integer,\n\t\tPickedByPersonID as integer,\n\t\tContactPersonID as integer,\n\t\tBackorderOrderID as integer,\n\t\tOrderDate as date,\n\t\tExpectedDeliveryDate as date,\n\t\tCustomerPurchaseOrderNumber as string,\n\t\tIsUndersupplyBackordered as boolean,\n\t\tComments as string,\n\t\tDeliveryInstructions as string,\n\t\tInternalComments as string,\n\t\tPickingCompletedWhen as timestamp,\n\t\tLastEditedBy as integer,\n\t\tLastEditedWhen as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> odsDB\nsource(output(\n\t\tOrderID as integer,\n\t\tCustomerID as integer,\n\t\tSalespersonPersonID as integer,\n\t\tPickedByPersonID as integer,\n\t\tContactPersonID as integer,\n\t\tBackorderOrderID as integer,\n\t\tOrderDate as date,\n\t\tExpectedDeliveryDate as date,\n\t\tCustomerPurchaseOrderNumber as string,\n\t\tIsUndersupplyBackordered as boolean,\n\t\tComments as string,\n\t\tDeliveryInstructions as string,\n\t\tInternalComments as string,\n\t\tPickingCompletedWhen as timestamp,\n\t\tLastEditedBy as integer,\n\t\tLastEditedWhen as timestamp,\n\t\tIsActive as integer,\n\t\tSurrogate as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> intergrationDB\nodsDB derive(IsActive = 1) ~> addingisactive\nodsDB, Select3 lookup(OrderID == SQL_OrderID,\n\tmultiple: true,\n\tbroadcast: 'auto')~> Lookup1\nLookup1 filter(!isNull(SQL_OrderID)) ~> existingRow\nSelect4 derive(SQL_IsActive = 0) ~> DerivedColumn1\nDerivedColumn1 alterRow(updateIf(1==1)) ~> AlterRow1\nintergrationDB select(mapColumn(\n\t\tSQL_OrderID = OrderID,\n\t\tSQL_CustomerID = CustomerID,\n\t\tSQL_SalespersonPersonID = SalespersonPersonID,\n\t\tSQL_PickedByPersonID = PickedByPersonID,\n\t\tSQL_ContactPersonID = ContactPersonID,\n\t\tSQL_BackorderOrderID = BackorderOrderID,\n\t\tSQL_OrderDate = OrderDate,\n\t\tSQL_ExpectedDeliveryDate = ExpectedDeliveryDate,\n\t\tSQL_CustomerPurchaseOrderNumber = CustomerPurchaseOrderNumber,\n\t\tSQL_IsUndersupplyBackordered = IsUndersupplyBackordered,\n\t\tSQL_Comments = Comments,\n\t\tSQL_DeliveryInstructions = DeliveryInstructions,\n\t\tSQL_InternalComments = InternalComments,\n\t\tSQL_PickingCompletedWhen = PickingCompletedWhen,\n\t\tSQL_LastEditedBy = LastEditedBy,\n\t\tSQL_LastEditedWhen = LastEditedWhen,\n\t\tSQL_IsActive = IsActive,\n\t\tSurrogate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nexistingRow select(mapColumn(\n\t\tSQL_OrderID,\n\t\tSQL_CustomerID,\n\t\tSQL_SalespersonPersonID,\n\t\tSQL_PickedByPersonID,\n\t\tSQL_ContactPersonID,\n\t\tSQL_BackorderOrderID,\n\t\tSQL_OrderDate,\n\t\tSQL_ExpectedDeliveryDate,\n\t\tSQL_CustomerPurchaseOrderNumber,\n\t\tSQL_IsUndersupplyBackordered,\n\t\tSQL_Comments,\n\t\tSQL_DeliveryInstructions,\n\t\tSQL_InternalComments,\n\t\tSQL_PickingCompletedWhen,\n\t\tSQL_LastEditedBy,\n\t\tSQL_LastEditedWhen,\n\t\tSQL_IsActive,\n\t\tSQL_Surrogate = Surrogate\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select4\naddingisactive sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\terrorHandlingOption: 'stopOnFirstError') ~> intergrationPlusAct\nAlterRow1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tOrderID as integer,\n\t\tCustomerID as integer,\n\t\tSalespersonPersonID as integer,\n\t\tPickedByPersonID as integer,\n\t\tContactPersonID as integer,\n\t\tBackorderOrderID as integer,\n\t\tOrderDate as date,\n\t\tExpectedDeliveryDate as date,\n\t\tCustomerPurchaseOrderNumber as string,\n\t\tIsUndersupplyBackordered as boolean,\n\t\tComments as string,\n\t\tDeliveryInstructions as string,\n\t\tInternalComments as string,\n\t\tPickingCompletedWhen as timestamp,\n\t\tLastEditedBy as integer,\n\t\tLastEditedWhen as timestamp,\n\t\tIsActive as integer,\n\t\tSurrogate as long\n\t),\n\tdeletable:false,\n\tinsertable:false,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['Surrogate'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tOrderID = SQL_OrderID,\n\t\tCustomerID = SQL_CustomerID,\n\t\tSalespersonPersonID = SQL_SalespersonPersonID,\n\t\tPickedByPersonID = SQL_PickedByPersonID,\n\t\tContactPersonID = SQL_ContactPersonID,\n\t\tBackorderOrderID = SQL_BackorderOrderID,\n\t\tOrderDate = SQL_OrderDate,\n\t\tExpectedDeliveryDate = SQL_ExpectedDeliveryDate,\n\t\tCustomerPurchaseOrderNumber = SQL_CustomerPurchaseOrderNumber,\n\t\tIsUndersupplyBackordered = SQL_IsUndersupplyBackordered,\n\t\tComments = SQL_Comments,\n\t\tDeliveryInstructions = SQL_DeliveryInstructions,\n\t\tInternalComments = SQL_InternalComments,\n\t\tPickingCompletedWhen = SQL_PickingCompletedWhen,\n\t\tLastEditedBy = SQL_LastEditedBy,\n\t\tLastEditedWhen = SQL_LastEditedWhen,\n\t\tIsActive = SQL_IsActive,\n\t\tSurrogate = SQL_Surrogate\n\t)) ~> sink1"
		}
	}
}